# -*- coding: utf-8 -*-
"""image compression K-Means.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1sefbYWo9E0-Q-AGzVKoRJcgoqnwvWwuS
"""

from google.colab import files
uploaded=files.upload()

#import libraries

import pandas as pd
import numpy as np
import random as rd 

from sklearn.cluster import KMeans
import matplotlib.pyplot as plt 
from matplotlib.pyplot import imread

#load the image
img = imread('Sandeep_Unnikrishnan.jpg')
img_size = img.shape

print(img.shape)
print(img.ndim)

x = img.reshape(img_size[0]*img_size[1],img_size[2])

print(x.shape)
print(x.ndim)

km = KMeans(n_clusters = 30)
km.fit(x)

x_compressed = km.cluster_centers_[km.labels_]
x_compressed = np.clip(x_compressed.astype('uint8'),0,225)
x_compressed = x_compressed.reshape(img_size[0],img_size[1],img_size[2])

#plotting
fig, ax = plt.subplots(1,2, figsize = (12,8))
ax[0].imshow(img)
ax[0].set_title('Original Image')
ax[1].imshow(x_compressed)
ax[1].set_title('Compressed Image with 30 Colors')
for ax in fig.axes:
  ax.axis('off')
plt.tight_layout();
